{"version":"2.0","models":[{"Key":"8","Name":"EnergyBudget","Definition":{"version":"v2","readme":"This model provides visualizations around energy savings.\n\nYou can set monthly budgets for energy consumption  and then post regular energy consumption data and get analytics about your usage.\n\nEnergy consumption will be classified by their 'energy type'.\n\nAn example would be: 'Cooling' or 'Mechanical' or 'Electrical'. These define different kinds of energy consumption.\n\nYou can define budgets for different energy types.\n\n## Energy Types\n\nEnergy consumption is recorded against an energy type. This can be any label or text - but its recommended you use a simple lower case word. Examples:\n\n* electrical\n* mechanical\n* cooling\n\nYou do not need to predefine your energy types. When you record values for a given energy type, it will automatically get registered as a new type.\n\n\n### Calculated Energy Types\n\nSometimes it's useful to see consumption and budget for multiple energy types together.\nFor example, you can have 'Essential' as one energy type which comprises 'Mechanical' and 'Electrical' and 'Non-Essential' which comprises only 'Cooling'.\n\nYou can define new energy types as calculated energy types which have one or more sub-energy types.\n\nYou do not directly record energy consumption against these calculated energy types. The consumption will instead be calculated as the sum of all the energy from its sub energy types.\n\nYou can add/remove calculated energy types at any time independent of the energy consumption data already being recorded.\n","attributes":[],"flows":{"blocks":[{"title":"Find all documents","type":"modelcollections:findall","id":"34c53d8f-56bb-4e99-b30b-a255fb803a11","position":{"left":453,"top":82},"surface":"CategoryConsumptionForLocation","connections":{"inputs":[{"source":"a0cd1a16-8717-4115-e452-99e2b249c7ce:output:location","target":"34c53d8f-56bb-4e99-b30b-a255fb803a11:input:location"},{"source":"a0cd1a16-8717-4115-e452-99e2b249c7ce:output:month","target":"34c53d8f-56bb-4e99-b30b-a255fb803a11:input:month"},{"source":"a0cd1a16-8717-4115-e452-99e2b249c7ce:output:year","target":"34c53d8f-56bb-4e99-b30b-a255fb803a11:input:year"}],"outputs":[{"source":"34c53d8f-56bb-4e99-b30b-a255fb803a11:output:output","target":"52932253-a47c-4b14-891e-9bc07bc34da5:input:input"}]},"inputValues":[{"id":"trigger","type":"","label":"Trigger","value":"","description":"","documentation":"","transformation":"","disablelog":""},{"id":"year","type":"","label":"year","value":"","description":"","documentation":"","transformation":"","disablelog":""},{"id":"month","type":"","label":"month","value":"","description":"","documentation":"","transformation":"","disablelog":""},{"id":"location","type":"","label":"location","value":"","description":"","documentation":"","transformation":"","disablelog":""}],"outputValues":[{"id":"__error__","type":"error","label":"Error","description":"","documentation":"","example":"","dataType":""},{"id":"output","type":"","label":"All Output","description":"","documentation":"","example":"","dataType":""}],"CollectionName":"990e1f47-05ec-4225-e2c1-4037cdb70bac","configuration":"[{\"IsEither\":false,\"Conditions\":[{\"Attribute\":\"year\",\"Operator\":\"eq\",\"Value\":\"year\",\"IsPin\":true},{\"Attribute\":\"month\",\"Operator\":\"eq\",\"Value\":\"month\",\"IsPin\":true},{\"Attribute\":\"location\",\"Operator\":\"eq\",\"Value\":\"location\",\"IsPin\":true}],\"Groups\":[]}]","UpdateAsAttributes":false,"ReceiveIndividualFields":false,"TakeFilterFromPin":false,"timeout":5000},{"title":"Repeat Action","type":"repeataction","id":"c8837ab4-aa1a-4847-e5c1-a05b4841b4c1","position":{"left":540,"top":100},"surface":"AddValueBulk","connections":{"inputs":[{"source":"0b1ebff4-ea83-4b5c-f406-7479e1aadfa2:output:values","target":"c8837ab4-aa1a-4847-e5c1-a05b4841b4c1:input:list"},{"source":"e5d4b92e-068d-4dac-c81c-8d3c7b3d7255:output:location","target":"c8837ab4-aa1a-4847-e5c1-a05b4841b4c1:input:extra"}],"outputs":[{"source":"c8837ab4-aa1a-4847-e5c1-a05b4841b4c1:output:action","target":"7fbf6ff8-1696-4787-c504-0057bed6f1c1:input:__actionlink__"}]},"inputValues":[{"id":"list","type":"list","label":"Items","value":"","description":"","documentation":"","transformation":"","disablelog":""},{"id":"extra","type":"","label":"Extra","value":"","description":"","documentation":"","transformation":"","disablelog":""},{"id":"trigger","type":"","label":"Trigger","value":"","description":"","documentation":"","transformation":"","disablelog":""}],"outputValues":[{"id":"action","type":"actionlink","label":"Action","description":"","documentation":"","example":"","dataType":""},{"id":"done","type":"","label":"Done","description":"","documentation":"","example":"","dataType":""},{"id":"output","type":"","label":"Output","description":"","documentation":"","example":"","dataType":""}],"sequential":true},{"title":"Action","type":"actionstart","id":"567c595d-67bf-4978-b13a-68ca6ddf5fca","position":{"left":60,"top":60},"surface":"GetLocations","connections":{"inputs":[],"outputs":[{"source":"567c595d-67bf-4978-b13a-68ca6ddf5fca:output:output","target":"50344533-2b10-4f3a-be0e-d4bb96093bb1:input:trigger"}]},"inputValues":[],"outputValues":[{"id":"output","type":"","label":"All Output","description":"","documentation":"","example":"","dataType":""},{"id":"__error__","type":"error","label":"Error","description":"","documentation":"","example":"","dataType":""}],"actionName":"GetLocations","initiate":false,"published":false,"debug":false,"roles":[],"static":true,"canOverrideCredentials":false,"docs":"Retrieve a list of all defined locations and their energy budgets.\n\n\n"},{"title":"Action","type":"actionstart","id":"a0cd1a16-8717-4115-e452-99e2b249c7ce","position":{"left":100,"top":100},"surface":"CategoryConsumptionForLocation","connections":{"inputs":[],"outputs":[{"source":"a0cd1a16-8717-4115-e452-99e2b249c7ce:output:location","target":"34c53d8f-56bb-4e99-b30b-a255fb803a11:input:location"},{"source":"a0cd1a16-8717-4115-e452-99e2b249c7ce:output:month","target":"34c53d8f-56bb-4e99-b30b-a255fb803a11:input:month"},{"source":"a0cd1a16-8717-4115-e452-99e2b249c7ce:output:year","target":"34c53d8f-56bb-4e99-b30b-a255fb803a11:input:year"}]},"inputValues":[],"outputValues":[{"id":"output","type":"","label":"All Output","description":"","documentation":"","example":"","dataType":""},{"id":"__error__","type":"error","label":"Error","description":"","documentation":"","example":"","dataType":""},{"id":"location","type":"","label":"location","description":"","documentation":"","example":"","dataType":""},{"id":"year","type":"","label":"year","description":"","documentation":"","example":"","dataType":""},{"id":"month","type":"","label":"month","description":"","documentation":"","example":"","dataType":""}],"actionName":"CategoryConsumptionForLocation","initiate":false,"published":false,"debug":false,"roles":[],"static":true,"canOverrideCredentials":false,"docs":""},{"title":"Output","type":"actionoutput","id":"55fa9667-9f83-48d0-e4d7-0e6eb7d2823c","position":{"left":526,"top":311},"surface":"DeleteCategory","connections":{"inputs":[{"source":"d0ea2c3c-ed1f-4d08-cb60-78f358bbccc0:output:output","target":"55fa9667-9f83-48d0-e4d7-0e6eb7d2823c:input:trigger"}],"outputs":[]},"inputValues":[{"id":"input","type":"","label":"Value","value":"deleted","description":"","documentation":"","transformation":"","disablelog":""},{"id":"trigger","type":"","label":"Trigger","value":"","description":"","documentation":"","transformation":"","disablelog":""}],"outputValues":[],"fieldName":"status"},{"title":"Find all documents","type":"modelcollections:findall","id":"72934bb1-8f28-40aa-c5a0-8b404ea09d9b","position":{"left":369,"top":167},"surface":"GetCategories","connections":{"inputs":[{"source":"27be8965-0237-43f3-921e-92c27d5d468c:output:output","target":"72934bb1-8f28-40aa-c5a0-8b404ea09d9b:input:trigger"}],"outputs":[{"source":"72934bb1-8f28-40aa-c5a0-8b404ea09d9b:output:output","target":"c3d9bbec-ac33-4455-c72c-053a9691607d:input:input"}]},"inputValues":[{"id":"trigger","type":"","label":"Trigger","value":"","description":"","documentation":"","transformation":"","disablelog":""}],"outputValues":[{"id":"__error__","type":"error","label":"Error","description":"","documentation":"","example":"","dataType":""},{"id":"output","type":"","label":"All Output","description":"","documentation":"","example":"","dataType":""}],"CollectionName":"e692f2de-5335-4bcc-da84-53a32b5732ad","configuration":"[]","UpdateAsAttributes":false,"ReceiveIndividualFields":false,"TakeFilterFromPin":false,"timeout":5000},{"title":"Output","type":"actionoutput","id":"9d7e7ef6-3d09-4e55-f886-0bf106ffe03f","position":{"left":888,"top":101},"surface":"GetLocations","connections":{"inputs":[{"source":"50344533-2b10-4f3a-be0e-d4bb96093bb1:output:output","target":"9d7e7ef6-3d09-4e55-f886-0bf106ffe03f:input:input"}],"outputs":[]},"inputValues":[{"id":"input","type":"","label":"Value","value":"","description":"","documentation":"","transformation":"","disablelog":""},{"id":"trigger","type":"","label":"Trigger","value":"","description":"","documentation":"","transformation":"","disablelog":""}],"outputValues":[],"fieldName":""},{"title":"Action","type":"actionstart","id":"e5d4b92e-068d-4dac-c81c-8d3c7b3d7255","position":{"left":100,"top":100},"surface":"AddValueBulk","connections":{"inputs":[],"outputs":[{"source":"e5d4b92e-068d-4dac-c81c-8d3c7b3d7255:output:values","target":"0b1ebff4-ea83-4b5c-f406-7479e1aadfa2:input:values"},{"source":"e5d4b92e-068d-4dac-c81c-8d3c7b3d7255:output:location","target":"c8837ab4-aa1a-4847-e5c1-a05b4841b4c1:input:extra"}]},"inputValues":[],"outputValues":[{"id":"output","type":"","label":"All Output","description":"","documentation":"","example":"","dataType":""},{"id":"__error__","type":"error","label":"Error","description":"","documentation":"","example":"","dataType":""},{"id":"values","type":"","label":"values","description":"","documentation":"","example":"","dataType":""},{"id":"location","type":"","label":"location","description":"","documentation":"","example":"","dataType":""}],"actionName":"AddValueBulk","initiate":false,"published":false,"debug":false,"roles":[],"static":true,"canOverrideCredentials":false,"docs":""},{"title":"Action","type":"actionstart","id":"40fe7e19-b46c-40e7-a08a-9339de42e42e","position":{"left":67,"top":100},"surface":"UpdateBudget","connections":{"inputs":[],"outputs":[{"source":"40fe7e19-b46c-40e7-a08a-9339de42e42e:output:budget","target":"d97a6545-564f-4126-f5d3-4f49aada8492:input:input"},{"source":"40fe7e19-b46c-40e7-a08a-9339de42e42e:output:location","target":"1542c611-629c-4474-dd1c-06bcc5ff2b91:input:location"},{"source":"40fe7e19-b46c-40e7-a08a-9339de42e42e:output:budget","target":"1542c611-629c-4474-dd1c-06bcc5ff2b91:input:values"},{"source":"40fe7e19-b46c-40e7-a08a-9339de42e42e:output:location","target":"1542c611-629c-4474-dd1c-06bcc5ff2b91:input:location"},{"source":"40fe7e19-b46c-40e7-a08a-9339de42e42e:output:category","target":"1542c611-629c-4474-dd1c-06bcc5ff2b91:input:category"}]},"inputValues":[],"outputValues":[{"id":"output","type":"","label":"All Output","description":"","documentation":"","example":"","dataType":""},{"id":"__error__","type":"error","label":"Error","description":"","documentation":"","example":"","dataType":""},{"id":"location","type":"","label":"location","description":"","documentation":"The location to set the budget for","example":"\"building1\"","dataType":""},{"id":"budget","type":"","label":"budget","description":"","documentation":"The payload is a JSON structure containing the following: The energy budget for each month in an array.  So  there will be 12 items in the array.","example":"[230,240,235,200,190,200,220,230,220,225,230,235]","dataType":""},{"id":"category","type":"","label":"category","description":"","documentation":"The energy type for which this budget is set","example":"\"electrical\"","dataType":""}],"actionName":"UpdateBudget","initiate":false,"published":false,"debug":true,"roles":[],"static":true,"canOverrideCredentials":false,"docs":"For a given location and energy type, assign monthly energy budgets."},{"title":"Output","type":"actionoutput","id":"a94b0a23-df86-4bf4-c38f-78de837894c8","position":{"left":540,"top":100},"surface":"ConsumptionForLocation","connections":{"inputs":[{"source":"53fedec9-ddfe-45b8-bb70-878236ac7ff8:output:values","target":"a94b0a23-df86-4bf4-c38f-78de837894c8:input:input"}],"outputs":[]},"inputValues":[{"id":"input","type":"","label":"Value","value":"","description":"","documentation":"","transformation":"","disablelog":""},{"id":"trigger","type":"","label":"Trigger","value":"","description":"","documentation":"","transformation":"","disablelog":""}],"outputValues":[],"fieldName":""},{"title":"Action","type":"actionstart","id":"a6f19482-2ba1-41bf-9fab-9fe4ec88a3cb","position":{"left":60,"top":230},"surface":"AddValue","connections":{"inputs":[],"outputs":[{"source":"a6f19482-2ba1-41bf-9fab-9fe4ec88a3cb:output:output","target":"1dbc87b1-3144-4bf6-d70b-4a53e776c1fe:input:trigger"}]},"inputValues":[],"outputValues":[{"id":"output","type":"","label":"All Output","description":"","documentation":"","example":"","dataType":""},{"id":"__error__","type":"error","label":"Error","description":"","documentation":"","example":"","dataType":""},{"id":"year","type":"","label":"year","description":"","documentation":"The year that the data point is added for","example":"\"2020\"","dataType":""},{"id":"month","type":"","label":"month","description":"","documentation":"The month that the data point is added for. Months go from 1 to 12.","example":"\"3\"","dataType":""},{"id":"location","type":"","label":"location","description":"","documentation":"Location to add energy consumption information for","example":"\"building1\"","dataType":""},{"id":"value","type":"","label":"value","description":"","documentation":"The energy value in kWh","example":"230","dataType":""},{"id":"category","type":"","label":"category","description":"","documentation":"The energy type that this energy is being recorded under","example":"","dataType":""}],"actionName":"AddValue","initiate":false,"published":false,"debug":true,"roles":[],"static":true,"canOverrideCredentials":false,"docs":"Update the consumption information for a location and energy type for a given month and year."},{"title":"Action","type":"actionstart","id":"751b5952-8fce-4ab3-e6d0-48290251c5bb","position":{"left":68,"top":149},"surface":"GetBudget","connections":{"inputs":[],"outputs":[{"source":"751b5952-8fce-4ab3-e6d0-48290251c5bb:output:location","target":"25de88e0-0483-4302-dee8-e164b6166822:input:location"},{"source":"751b5952-8fce-4ab3-e6d0-48290251c5bb:output:category","target":"25de88e0-0483-4302-dee8-e164b6166822:input:category"}]},"inputValues":[],"outputValues":[{"id":"output","type":"","label":"All Output","description":"","documentation":"","example":"","dataType":""},{"id":"__error__","type":"error","label":"Error","description":"","documentation":"","example":"","dataType":""},{"id":"location","type":"","label":"location","description":"","documentation":"The location for which budget information has to be retrieved","example":"\"building1\"","dataType":""},{"id":"category","type":"","label":"category","description":"","documentation":"The energy type for which budget information is to be retrieved. This can be a calculated energy type that has sub-energy types defined for it.","example":"\"electrical\"","dataType":""}],"actionName":"GetBudget","initiate":false,"published":false,"debug":false,"roles":[],"static":true,"canOverrideCredentials":false,"docs":"Retrieve the monthly energy budgets set for a given location and energy type.\n\nIf the energy type has sub energy types defined, the monthly budget values will be the accumulated total of all the sub energy types.\n\n# Output\n\nThe response contains an array of budgets for each month. There are 12 items in the array - each item representing a month.\n\n```\n{\n   \"location\":\"building1\",\n   \"values\":[50,23,45,44,52,20,20,30,45,10,20,15]\n}\n```"},{"title":"Replace one document","type":"modelcollections:replaceone","id":"1dbc87b1-3144-4bf6-d70b-4a53e776c1fe","position":{"left":434,"top":272},"surface":"AddValue","connections":{"inputs":[{"source":"a6f19482-2ba1-41bf-9fab-9fe4ec88a3cb:output:output","target":"1dbc87b1-3144-4bf6-d70b-4a53e776c1fe:input:trigger"}],"outputs":[]},"inputValues":[{"id":"trigger","type":"","label":"Trigger","value":"","description":"","documentation":"","transformation":"","disablelog":""},{"id":"year","type":"","label":"year","value":"#{input.year}","description":"","documentation":"","transformation":"text","disablelog":""},{"id":"month","type":"","label":"month","value":"#{input.month}","description":"","documentation":"","transformation":"text","disablelog":""},{"id":"value","type":"","label":"value","value":"#{input.value}","description":"","documentation":"","transformation":"text","disablelog":""},{"id":"location","type":"","label":"location","value":"#{input.location}","description":"","documentation":"","transformation":"text","disablelog":""},{"id":"category","type":"","label":"category","value":"#{input.category}","description":"","documentation":"","transformation":"text","disablelog":""},{"id":"__data__","type":"text","label":"Data","value":"","description":"Data to be inserted","documentation":"","transformation":"","disablelog":""}],"outputValues":[{"id":"__error__","type":"error","label":"Error","description":"","documentation":"","example":"","dataType":""},{"id":"output","type":"","label":"All Output","description":"","documentation":"","example":"","dataType":""}],"CollectionName":"990e1f47-05ec-4225-e2c1-4037cdb70bac","configuration":"[{\"IsEither\":false,\"Conditions\":[{\"Attribute\":\"year\",\"Operator\":\"eq\",\"Value\":\"year\",\"IsPin\":true},{\"Attribute\":\"month\",\"Operator\":\"eq\",\"Value\":\"month\",\"IsPin\":true},{\"Attribute\":\"location\",\"Operator\":\"eq\",\"Value\":\"location\",\"IsPin\":true},{\"Attribute\":\"category\",\"Operator\":\"eq\",\"Value\":\"category\",\"IsPin\":true}],\"Groups\":[]}]","UpdateAsAttributes":true,"ReceiveIndividualFields":false,"TakeFilterFromPin":false,"timeout":5000},{"title":"Action","type":"actionstart","id":"1a647709-f57f-4695-82c4-662e2a0d7b91","position":{"left":100,"top":100},"surface":"ConsumptionForLocation","connections":{"inputs":[],"outputs":[{"source":"1a647709-f57f-4695-82c4-662e2a0d7b91:output:year","target":"53fedec9-ddfe-45b8-bb70-878236ac7ff8:input:year"},{"source":"1a647709-f57f-4695-82c4-662e2a0d7b91:output:location","target":"53fedec9-ddfe-45b8-bb70-878236ac7ff8:input:location"},{"source":"1a647709-f57f-4695-82c4-662e2a0d7b91:output:category","target":"53fedec9-ddfe-45b8-bb70-878236ac7ff8:input:category"}]},"inputValues":[],"outputValues":[{"id":"output","type":"","label":"All Output","description":"","documentation":"","example":"","dataType":""},{"id":"__error__","type":"error","label":"Error","description":"","documentation":"","example":"","dataType":""},{"id":"location","type":"","label":"location","description":"","documentation":"","example":"","dataType":""},{"id":"year","type":"","label":"year","description":"","documentation":"","example":"","dataType":""},{"id":"category","type":"","label":"category","description":"","documentation":"","example":"","dataType":""}],"actionName":"ConsumptionForLocation","initiate":false,"published":false,"debug":false,"roles":[],"static":true,"canOverrideCredentials":false,"docs":"For a given location, energy type and year, return the monthly consumptions that have been recorded.\n\nIf the energy type is a calculated type, the energy consumption data will be the sum of all sub energy types.\n\n# Output\n\nThe output consists of an array of location/month/year/value items.\n\n```\n[\n  {\"year\":\"2020\",\"month\":\"1\",\"value\":\"198\"},\n  {\"year\":\"2020\",\"month\":\"2\",\"value\":\"200\"},\n  {\"year\":\"2020\",\"month\":\"3\",\"value\":\"192\"}\n]\n```"},{"title":"Output","type":"actionoutput","id":"52932253-a47c-4b14-891e-9bc07bc34da5","position":{"left":817,"top":90},"surface":"CategoryConsumptionForLocation","connections":{"inputs":[{"source":"34c53d8f-56bb-4e99-b30b-a255fb803a11:output:output","target":"52932253-a47c-4b14-891e-9bc07bc34da5:input:input"}],"outputs":[]},"inputValues":[{"id":"input","type":"","label":"Value","value":"","description":"","documentation":"","transformation":"","disablelog":""},{"id":"trigger","type":"","label":"Trigger","value":"","description":"","documentation":"","transformation":"","disablelog":""}],"outputValues":[],"fieldName":""},{"title":"Find all documents","type":"modelcollections:findall","id":"50344533-2b10-4f3a-be0e-d4bb96093bb1","position":{"left":367,"top":234},"surface":"GetLocations","connections":{"inputs":[{"source":"567c595d-67bf-4978-b13a-68ca6ddf5fca:output:output","target":"50344533-2b10-4f3a-be0e-d4bb96093bb1:input:trigger"}],"outputs":[{"source":"50344533-2b10-4f3a-be0e-d4bb96093bb1:output:output","target":"9d7e7ef6-3d09-4e55-f886-0bf106ffe03f:input:input"}]},"inputValues":[{"id":"trigger","type":"","label":"Trigger","value":"","description":"","documentation":"","transformation":"","disablelog":""}],"outputValues":[{"id":"__error__","type":"error","label":"Error","description":"","documentation":"","example":"","dataType":""},{"id":"output","type":"","label":"All Output","description":"","documentation":"","example":"","dataType":""}],"CollectionName":"c0ecc1d2-c1ef-4db8-f5c6-f260e438b66a","configuration":"[]","UpdateAsAttributes":false,"ReceiveIndividualFields":false,"TakeFilterFromPin":false,"timeout":5000},{"title":"Output","type":"actionoutput","id":"6513a99d-a45f-477d-d477-06fcadf09229","position":{"left":817,"top":90},"surface":"ConsumptionForLocationMonth","connections":{"inputs":[{"source":"097dafad-630d-4cf1-a208-67219475e888:output:values","target":"6513a99d-a45f-477d-d477-06fcadf09229:input:input"}],"outputs":[]},"inputValues":[{"id":"input","type":"","label":"Value","value":"","description":"","documentation":"","transformation":"","disablelog":""},{"id":"trigger","type":"","label":"Trigger","value":"","description":"","documentation":"","transformation":"","disablelog":""}],"outputValues":[],"fieldName":""},{"title":"Action","type":"actionstart","id":"2c4acc75-9169-49a7-93bc-e0d9d2508141","position":{"left":100,"top":100},"surface":"UpdateCategory","connections":{"inputs":[],"outputs":[{"source":"2c4acc75-9169-49a7-93bc-e0d9d2508141:output:label","target":"b28df3cb-3ebe-4e8c-becf-bc13d6742377:input:label"},{"source":"2c4acc75-9169-49a7-93bc-e0d9d2508141:output:subcategories","target":"b28df3cb-3ebe-4e8c-becf-bc13d6742377:input:subcategories"},{"source":"2c4acc75-9169-49a7-93bc-e0d9d2508141:output:id","target":"b28df3cb-3ebe-4e8c-becf-bc13d6742377:input:id"}]},"inputValues":[],"outputValues":[{"id":"output","type":"","label":"All Output","description":"","documentation":"","example":"","dataType":""},{"id":"__error__","type":"error","label":"Error","description":"","documentation":"","example":"","dataType":""},{"id":"label","type":"","label":"label","description":"","documentation":"","example":"","dataType":""},{"id":"subcategories","type":"","label":"subcategories","description":"","documentation":"","example":"","dataType":""},{"id":"id","type":"","label":"id","description":"","documentation":"","example":"","dataType":""}],"actionName":"UpdateCategory","initiate":false,"published":false,"debug":true,"roles":[],"static":true,"canOverrideCredentials":false,"docs":""},{"title":"Delete all document","type":"modelcollections:deleteall","id":"d0ea2c3c-ed1f-4d08-cb60-78f358bbccc0","position":{"left":295,"top":332},"surface":"DeleteCategory","connections":{"inputs":[{"source":"92b68200-fd76-4676-c225-3b01e0dafd76:output:output","target":"d0ea2c3c-ed1f-4d08-cb60-78f358bbccc0:input:trigger"}],"outputs":[{"source":"d0ea2c3c-ed1f-4d08-cb60-78f358bbccc0:output:output","target":"55fa9667-9f83-48d0-e4d7-0e6eb7d2823c:input:trigger"}]},"inputValues":[{"id":"trigger","type":"","label":"Trigger","value":"","description":"","documentation":"","transformation":"","disablelog":""},{"id":"category","type":"","label":"category","value":"#{input.category}","description":"","documentation":"","transformation":"","disablelog":""}],"outputValues":[{"id":"__error__","type":"error","label":"Error","description":"","documentation":"","example":"","dataType":""},{"id":"output","type":"","label":"All Output","description":"","documentation":"","example":"","dataType":""}],"CollectionName":"c0ecc1d2-c1ef-4db8-f5c6-f260e438b66a","configuration":"[{\"IsEither\":true,\"Conditions\":[{\"Attribute\":\"category\",\"Operator\":\"eq\",\"Value\":\"category\",\"IsPin\":true}],\"Groups\":[]}]","UpdateAsAttributes":false,"ReceiveIndividualFields":false,"TakeFilterFromPin":false,"timeout":5000},{"title":"Find all documents","type":"modelcollections:findall","id":"537132c7-2623-4a74-cffa-3c001dffff18","position":{"left":525,"top":108},"surface":"ConsumptionBreakdownForLocationMonth","connections":{"inputs":[{"source":"294b2c89-6486-418f-f0b9-95dcfa4c217a:output:location","target":"537132c7-2623-4a74-cffa-3c001dffff18:input:location"},{"source":"294b2c89-6486-418f-f0b9-95dcfa4c217a:output:year","target":"537132c7-2623-4a74-cffa-3c001dffff18:input:year"},{"source":"294b2c89-6486-418f-f0b9-95dcfa4c217a:output:month","target":"537132c7-2623-4a74-cffa-3c001dffff18:input:month"}],"outputs":[{"source":"537132c7-2623-4a74-cffa-3c001dffff18:output:output","target":"6ab3ba61-c49a-49e4-b585-f1a54c0791ea:input:input"}]},"inputValues":[{"id":"trigger","type":"","label":"Trigger","value":"","description":"","documentation":"","transformation":"","disablelog":""},{"id":"month","type":"","label":"month","value":"","description":"","documentation":"","transformation":"","disablelog":""},{"id":"year","type":"","label":"year","value":"","description":"","documentation":"","transformation":"","disablelog":""},{"id":"location","type":"","label":"location","value":"","description":"","documentation":"","transformation":"","disablelog":""}],"outputValues":[{"id":"__error__","type":"error","label":"Error","description":"","documentation":"","example":"","dataType":""},{"id":"output","type":"","label":"All Output","description":"","documentation":"","example":"","dataType":""}],"CollectionName":"990e1f47-05ec-4225-e2c1-4037cdb70bac","configuration":"[{\"IsEither\":false,\"Conditions\":[{\"Attribute\":\"month\",\"Operator\":\"eq\",\"Value\":\"month\",\"IsPin\":true},{\"Attribute\":\"year\",\"Operator\":\"eq\",\"Value\":\"year\",\"IsPin\":true},{\"Attribute\":\"location\",\"Operator\":\"eq\",\"Value\":\"location\",\"IsPin\":true}],\"Groups\":[]}]","UpdateAsAttributes":false,"ReceiveIndividualFields":false,"TakeFilterFromPin":false,"timeout":5000},{"title":"ES6Javascript","type":"es6javascript","id":"25de88e0-0483-4302-dee8-e164b6166822","position":{"left":379,"top":179},"surface":"GetBudget","connections":{"inputs":[{"source":"751b5952-8fce-4ab3-e6d0-48290251c5bb:output:location","target":"25de88e0-0483-4302-dee8-e164b6166822:input:location"},{"source":"751b5952-8fce-4ab3-e6d0-48290251c5bb:output:category","target":"25de88e0-0483-4302-dee8-e164b6166822:input:category"}],"outputs":[{"source":"25de88e0-0483-4302-dee8-e164b6166822:output:values","target":"0faa4e98-2be7-4e85-977b-0b7086a09afa:input:input"},{"source":"25de88e0-0483-4302-dee8-e164b6166822:output:values","target":"001227d8-6f6b-4de4-93f0-85e02ab0eafa:input:trigger"}]},"inputValues":[{"id":"trigger","type":"","label":"Trigger","value":"","description":"","documentation":"","transformation":"","disablelog":""},{"id":"location","type":"","label":"location","value":"","description":"","documentation":"","transformation":"","disablelog":""},{"id":"category","type":"","label":"category","value":"","description":"","documentation":"","transformation":"","disablelog":""}],"outputValues":[{"id":"__error__","type":"error","label":"Error","description":"","documentation":"","example":"","dataType":""},{"id":"values","type":"","label":"values","description":"","documentation":"","example":"","dataType":""}],"description":"","code":"let dc = lucy.currentModel().collections();\nlet {category,location} = runtime.inputs();\nasync function getCategoryList(c) {\n    let item = await dc.findOne('categories',{'id':c},{});\n    if (!item) {\n        return [c];\n    }\n    return item.subcategories || [c];\n}\n\nasync function doit() {\n    let categories = await getCategoryList(category);\n\n    let budgets = await dc.findMany('budget',{'$and':[\n        {'location':location},\n        {'category':{'$in':categories}}\n    ]},{});\n\n    let values = [];\n    for(var i=0;i<12;i++) {\n        let sum = budgets.reduce((prev,cur) => prev + Number(cur.values[i])||0,0);\n        values.push(sum);\n    }\n    return values;\n}\ndoit().then(values => runtime.done({values})).catch(e => runtime.error(e));","timeoutMilliseconds":5000},{"title":"ES6Javascript","type":"es6javascript","id":"53fedec9-ddfe-45b8-bb70-878236ac7ff8","position":{"left":320,"top":100},"surface":"ConsumptionForLocation","connections":{"inputs":[{"source":"1a647709-f57f-4695-82c4-662e2a0d7b91:output:year","target":"53fedec9-ddfe-45b8-bb70-878236ac7ff8:input:year"},{"source":"1a647709-f57f-4695-82c4-662e2a0d7b91:output:location","target":"53fedec9-ddfe-45b8-bb70-878236ac7ff8:input:location"},{"source":"1a647709-f57f-4695-82c4-662e2a0d7b91:output:category","target":"53fedec9-ddfe-45b8-bb70-878236ac7ff8:input:category"}],"outputs":[{"source":"53fedec9-ddfe-45b8-bb70-878236ac7ff8:output:values","target":"a94b0a23-df86-4bf4-c38f-78de837894c8:input:input"}]},"inputValues":[{"id":"trigger","type":"","label":"Trigger","value":"","description":"","documentation":"","transformation":"","disablelog":""},{"id":"location","type":"","label":"location","value":"","description":"","documentation":"","transformation":"","disablelog":""},{"id":"year","type":"","label":"year","value":"","description":"","documentation":"","transformation":"","disablelog":""},{"id":"category","type":"","label":"category","value":"","description":"","documentation":"","transformation":"","disablelog":""}],"outputValues":[{"id":"__error__","type":"error","label":"Error","description":"","documentation":"","example":"","dataType":""},{"id":"values","type":"","label":"values","description":"","documentation":"","example":"","dataType":""}],"description":"","code":"let dc = lucy.currentModel().collections();\nlet {category,location,year} = runtime.inputs();\nasync function getCategoryList(c) {\n    let item = await dc.findOne('categories',{'id':c},{});\n    if (!item) {\n        return [c];\n    }\n    return item.subcategories || [c];\n}\n\nasync function doit() {\n    let categories = await getCategoryList(category);\n\n    let values = await dc.findMany('consumption',{\"$and\":\n    [\n        {\"location\":{\"$eq\":location}},\n        {\"year\":{\"$eq\":year}},\n        {\"category\":{\"$in\":categories}},\n    ]},{});\n    let items = {};\n    for(let i in  values){\n        let value = values[i];\n        let key = `${value.year},${value.month}`;\n        if (!items[key]) {\n            items[key]= 0;\n        }\n        items[key] = items[key]+ Number(value.value);\n    }\n\n    let rows = [];\n    let keys = Object.keys(items);\n    for(var v in keys) {\n        let k = keys[v];\n        let [year,month] = k.split(',')\n        rows.push({location,year,month,value:Number(items[k])||0});\n    }\n    return rows;\n\n}\ndoit().then(values => runtime.done({values})).catch(e => runtime.error(e));","timeoutMilliseconds":5000},{"title":"Output","type":"actionoutput","id":"6ab3ba61-c49a-49e4-b585-f1a54c0791ea","position":{"left":817,"top":90},"surface":"ConsumptionBreakdownForLocationMonth","connections":{"inputs":[{"source":"537132c7-2623-4a74-cffa-3c001dffff18:output:output","target":"6ab3ba61-c49a-49e4-b585-f1a54c0791ea:input:input"}],"outputs":[]},"inputValues":[{"id":"input","type":"","label":"Value","value":"","description":"","documentation":"","transformation":"","disablelog":""},{"id":"trigger","type":"","label":"Trigger","value":"","description":"","documentation":"","transformation":"","disablelog":""}],"outputValues":[],"fieldName":""},{"title":"Output","type":"actionoutput","id":"c3d9bbec-ac33-4455-c72c-053a9691607d","position":{"left":692,"top":171},"surface":"GetCategories","connections":{"inputs":[{"source":"72934bb1-8f28-40aa-c5a0-8b404ea09d9b:output:output","target":"c3d9bbec-ac33-4455-c72c-053a9691607d:input:input"}],"outputs":[]},"inputValues":[{"id":"input","type":"","label":"Value","value":"","description":"","documentation":"","transformation":"","disablelog":""},{"id":"trigger","type":"","label":"Trigger","value":"","description":"","documentation":"","transformation":"","disablelog":""}],"outputValues":[],"fieldName":""},{"title":"Action","type":"actionstart","id":"294b2c89-6486-418f-f0b9-95dcfa4c217a","position":{"left":100,"top":100},"surface":"ConsumptionBreakdownForLocationMonth","connections":{"inputs":[],"outputs":[{"source":"294b2c89-6486-418f-f0b9-95dcfa4c217a:output:location","target":"537132c7-2623-4a74-cffa-3c001dffff18:input:location"},{"source":"294b2c89-6486-418f-f0b9-95dcfa4c217a:output:year","target":"537132c7-2623-4a74-cffa-3c001dffff18:input:year"},{"source":"294b2c89-6486-418f-f0b9-95dcfa4c217a:output:month","target":"537132c7-2623-4a74-cffa-3c001dffff18:input:month"}]},"inputValues":[],"outputValues":[{"id":"output","type":"","label":"All Output","description":"","documentation":"","example":"","dataType":""},{"id":"__error__","type":"error","label":"Error","description":"","documentation":"","example":"","dataType":""},{"id":"location","type":"","label":"location","description":"","documentation":"","example":"","dataType":""},{"id":"year","type":"","label":"year","description":"","documentation":"","example":"","dataType":""},{"id":"month","type":"","label":"month","description":"","documentation":"","example":"","dataType":""}],"actionName":"ConsumptionBreakdownForLocationMonth","initiate":false,"published":false,"debug":false,"roles":[],"static":true,"canOverrideCredentials":false,"docs":"Get consumption information for a given energy type, year, month and location"},{"title":"Replace one document","type":"modelcollections:replaceone","id":"7c6d996f-175f-49ef-8209-cafce957fedb","position":{"left":1070,"top":82},"surface":"AddValueBulk","connections":{"inputs":[{"source":"7fbf6ff8-1696-4787-c504-0057bed6f1c1:output:year","target":"7c6d996f-175f-49ef-8209-cafce957fedb:input:year"},{"source":"7fbf6ff8-1696-4787-c504-0057bed6f1c1:output:month","target":"7c6d996f-175f-49ef-8209-cafce957fedb:input:month"},{"source":"7fbf6ff8-1696-4787-c504-0057bed6f1c1:output:value","target":"7c6d996f-175f-49ef-8209-cafce957fedb:input:value"},{"source":"7fbf6ff8-1696-4787-c504-0057bed6f1c1:output:Extra","target":"7c6d996f-175f-49ef-8209-cafce957fedb:input:location"},{"source":"7fbf6ff8-1696-4787-c504-0057bed6f1c1:output:category","target":"7c6d996f-175f-49ef-8209-cafce957fedb:input:category"}],"outputs":[]},"inputValues":[{"id":"trigger","type":"","label":"Trigger","value":"","description":"","documentation":"","transformation":"","disablelog":""},{"id":"year","type":"","label":"year","value":"","description":"","documentation":"","transformation":"text","disablelog":""},{"id":"month","type":"","label":"month","value":"","description":"","documentation":"","transformation":"text","disablelog":""},{"id":"value","type":"","label":"value","value":"","description":"","documentation":"","transformation":"text","disablelog":""},{"id":"location","type":"","label":"location","value":"","description":"","documentation":"","transformation":"text","disablelog":""},{"id":"category","type":"","label":"category","value":"","description":"","documentation":"","transformation":"text","disablelog":""},{"id":"__data__","type":"text","label":"Data","value":"","description":"Data to be inserted","documentation":"","transformation":"","disablelog":""}],"outputValues":[{"id":"__error__","type":"error","label":"Error","description":"","documentation":"","example":"","dataType":""},{"id":"output","type":"","label":"All Output","description":"","documentation":"","example":"","dataType":""}],"CollectionName":"990e1f47-05ec-4225-e2c1-4037cdb70bac","configuration":"[{\"IsEither\":false,\"Conditions\":[{\"Attribute\":\"year\",\"Operator\":\"eq\",\"Value\":\"year\",\"IsPin\":true},{\"Attribute\":\"month\",\"Operator\":\"eq\",\"Value\":\"month\",\"IsPin\":true},{\"Attribute\":\"location\",\"Operator\":\"eq\",\"Value\":\"location\",\"IsPin\":true},{\"Attribute\":\"category\",\"Operator\":\"eq\",\"Value\":\"category\",\"IsPin\":true}],\"Groups\":[]}]","UpdateAsAttributes":true,"ReceiveIndividualFields":false,"TakeFilterFromPin":false,"timeout":5000},{"title":"Action","type":"linkedactionstart","id":"7fbf6ff8-1696-4787-c504-0057bed6f1c1","position":{"left":760,"top":100},"surface":"AddValueBulk","connections":{"inputs":[{"source":"c8837ab4-aa1a-4847-e5c1-a05b4841b4c1:output:action","target":"7fbf6ff8-1696-4787-c504-0057bed6f1c1:input:__actionlink__"}],"outputs":[{"source":"7fbf6ff8-1696-4787-c504-0057bed6f1c1:output:year","target":"7c6d996f-175f-49ef-8209-cafce957fedb:input:year"},{"source":"7fbf6ff8-1696-4787-c504-0057bed6f1c1:output:month","target":"7c6d996f-175f-49ef-8209-cafce957fedb:input:month"},{"source":"7fbf6ff8-1696-4787-c504-0057bed6f1c1:output:value","target":"7c6d996f-175f-49ef-8209-cafce957fedb:input:value"},{"source":"7fbf6ff8-1696-4787-c504-0057bed6f1c1:output:Extra","target":"7c6d996f-175f-49ef-8209-cafce957fedb:input:location"},{"source":"7fbf6ff8-1696-4787-c504-0057bed6f1c1:output:category","target":"7c6d996f-175f-49ef-8209-cafce957fedb:input:category"}]},"inputValues":[{"id":"__actionlink__","type":"actionlink","label":"","value":"","description":"","documentation":"","transformation":"","disablelog":""}],"outputValues":[{"id":"output","type":"","label":"All Output","description":"","documentation":"","example":"","dataType":""},{"id":"__error__","type":"error","label":"Error","description":"","documentation":"","example":"","dataType":""},{"id":"year","type":"","label":"year","description":"","documentation":"","example":"","dataType":""},{"id":"month","type":"","label":"month","description":"","documentation":"","example":"","dataType":""},{"id":"value","type":"","label":"value","description":"","documentation":"","example":"","dataType":""},{"id":"Extra","type":"","label":"Extra","description":"","documentation":"","example":"","dataType":""},{"id":"category","type":"","label":"category","description":"","documentation":"","example":"","dataType":""}],"actionName":"","initiate":false,"published":false,"debug":true,"roles":[],"static":true},{"title":"Output","type":"actionoutput","id":"5fb57472-1525-4d83-e75a-99d030566e38","position":{"left":540,"top":100},"surface":"UpdateCategory","connections":{"inputs":[{"source":"b28df3cb-3ebe-4e8c-becf-bc13d6742377:output:output","target":"5fb57472-1525-4d83-e75a-99d030566e38:input:trigger"}],"outputs":[]},"inputValues":[{"id":"input","type":"","label":"Value","value":"ok","description":"","documentation":"","transformation":"","disablelog":""},{"id":"trigger","type":"","label":"Trigger","value":"","description":"","documentation":"","transformation":"","disablelog":""}],"outputValues":[],"fieldName":"status"},{"title":"Action","type":"actionstart","id":"11d0d5ee-50bb-4614-efb1-0b3584815223","position":{"left":60,"top":60},"surface":"DeleteCategory","connections":{"inputs":[],"outputs":[{"source":"11d0d5ee-50bb-4614-efb1-0b3584815223:output:category","target":"92b68200-fd76-4676-c225-3b01e0dafd76:input:category"}]},"inputValues":[],"outputValues":[{"id":"output","type":"","label":"All Output","description":"","documentation":"","example":"","dataType":""},{"id":"__error__","type":"error","label":"Error","description":"","documentation":"","example":"","dataType":""},{"id":"category","type":"","label":"category","description":"","documentation":"The energy type to delete","example":"\"electrical\"","dataType":""}],"actionName":"DeleteCategory","initiate":false,"published":false,"debug":true,"roles":[],"static":true,"canOverrideCredentials":false,"docs":"Delete an energy type as well as all budgets defined for it.\n\n# Output\n\n```\n{\"status\":\"deleted\"}\n```"},{"title":"Output","type":"actionoutput","id":"0faa4e98-2be7-4e85-977b-0b7086a09afa","position":{"left":730,"top":322},"surface":"GetBudget","connections":{"inputs":[{"source":"25de88e0-0483-4302-dee8-e164b6166822:output:values","target":"0faa4e98-2be7-4e85-977b-0b7086a09afa:input:input"}],"outputs":[]},"inputValues":[{"id":"input","type":"","label":"Value","value":"","description":"","documentation":"","transformation":"","disablelog":""},{"id":"trigger","type":"","label":"Trigger","value":"","description":"","documentation":"","transformation":"","disablelog":""}],"outputValues":[],"fieldName":"values"},{"title":"Output","type":"actionoutput","id":"f58f48f8-14fe-4f57-a176-65ebaad4e5d6","position":{"left":956,"top":325},"surface":"GetLocationsAndCategories","connections":{"inputs":[{"source":"cf1482da-fd5b-4b2a-9dd0-9159b6ff89bb:output:categories","target":"f58f48f8-14fe-4f57-a176-65ebaad4e5d6:input:input"}],"outputs":[]},"inputValues":[{"id":"input","type":"","label":"Value","value":"","description":"","documentation":"","transformation":"","disablelog":""},{"id":"trigger","type":"","label":"Trigger","value":"","description":"","documentation":"","transformation":"","disablelog":""}],"outputValues":[],"fieldName":"categories"},{"title":"ES6Javascript","type":"es6javascript","id":"d97a6545-564f-4126-f5d3-4f49aada8492","position":{"left":379,"top":262},"surface":"UpdateBudget","connections":{"inputs":[{"source":"40fe7e19-b46c-40e7-a08a-9339de42e42e:output:budget","target":"d97a6545-564f-4126-f5d3-4f49aada8492:input:input"}],"outputs":[{"source":"d97a6545-564f-4126-f5d3-4f49aada8492:output:ok","target":"1542c611-629c-4474-dd1c-06bcc5ff2b91:input:trigger"}]},"inputValues":[{"id":"trigger","type":"","label":"Trigger","value":"","description":"","documentation":"","transformation":"","disablelog":""},{"id":"input","type":"","label":"input","value":"","description":"","documentation":"","transformation":"","disablelog":""}],"outputValues":[{"id":"__error__","type":"error","label":"Error","description":"","documentation":"","example":"","dataType":""},{"id":"ok","type":"","label":"ok","description":"","documentation":"","example":"","dataType":""}],"description":"Validate","code":"let x = runtime.inputs().input;\nif (!(x instanceof Array)) throw 'Budget values must be an array of 12 numbers. One for each month';\nif (x.length != 12) throw 'There must be 12 values in the budget array. One for each month';\nruntime.done({ok:true});","timeoutMilliseconds":5000},{"title":"Action","type":"actionstart","id":"b6db3877-68b6-4515-c0e2-6b9e9552f2ae","position":{"left":100,"top":100},"surface":"GetLocationsAndCategories","connections":{"inputs":[],"outputs":[{"source":"b6db3877-68b6-4515-c0e2-6b9e9552f2ae:output:output","target":"cf1482da-fd5b-4b2a-9dd0-9159b6ff89bb:input:trigger"}]},"inputValues":[],"outputValues":[{"id":"output","type":"","label":"All Output","description":"","documentation":"","example":"","dataType":""},{"id":"__error__","type":"error","label":"Error","description":"","documentation":"","example":"","dataType":""}],"actionName":"GetLocationsAndCategories","initiate":false,"published":false,"debug":false,"roles":[],"static":true,"canOverrideCredentials":false,"docs":""},{"title":"ES6Javascript","type":"es6javascript","id":"097dafad-630d-4cf1-a208-67219475e888","position":{"left":536,"top":332},"surface":"ConsumptionForLocationMonth","connections":{"inputs":[{"source":"5a471ef8-e835-49b9-beb0-72f42c25c45a:output:location","target":"097dafad-630d-4cf1-a208-67219475e888:input:location"},{"source":"5a471ef8-e835-49b9-beb0-72f42c25c45a:output:year","target":"097dafad-630d-4cf1-a208-67219475e888:input:year"},{"source":"5a471ef8-e835-49b9-beb0-72f42c25c45a:output:month","target":"097dafad-630d-4cf1-a208-67219475e888:input:month"},{"source":"5a471ef8-e835-49b9-beb0-72f42c25c45a:output:category","target":"097dafad-630d-4cf1-a208-67219475e888:input:category"}],"outputs":[{"source":"097dafad-630d-4cf1-a208-67219475e888:output:values","target":"6513a99d-a45f-477d-d477-06fcadf09229:input:input"}]},"inputValues":[{"id":"trigger","type":"","label":"Trigger","value":"","description":"","documentation":"","transformation":"","disablelog":""},{"id":"location","type":"","label":"location","value":"","description":"","documentation":"","transformation":"","disablelog":""},{"id":"year","type":"","label":"year","value":"","description":"","documentation":"","transformation":"","disablelog":""},{"id":"category","type":"","label":"category","value":"","description":"","documentation":"","transformation":"","disablelog":""},{"id":"month","type":"","label":"month","value":"","description":"","documentation":"","transformation":"","disablelog":""}],"outputValues":[{"id":"__error__","type":"error","label":"Error","description":"","documentation":"","example":"","dataType":""},{"id":"values","type":"","label":"values","description":"","documentation":"","example":"","dataType":""}],"description":"","code":"let dc = lucy.currentModel().collections();\nlet {category,location,year,month} = runtime.inputs();\nasync function getCategoryList(c) {\n    let item = await dc.findOne('categories',{'id':c},{});\n    if (!item) {\n        return [c];\n    }\n    return item.subcategories || [c];\n}\n\nasync function doit() {\n    let categories = await getCategoryList(category);\n\n    let values = await dc.findMany('consumption',{\"$and\":\n    [\n        {\"location\":{\"$eq\":location}},\n        {\"year\":{\"$eq\":year}},\n        {\"month\":{\"$eq\":''+Number(month)}},\n        {\"category\":{\"$in\":categories}},\n    ]},{});\n    let items = {};\n    for(let i in  values){\n        let value = values[i];\n        let key = `${value.year},${value.month}`;\n        if (!items[key]) {\n            items[key]= 0;\n        }\n        items[key] = items[key]+ Number(value.value);\n    }\n\n    let rows = [];\n    let keys = Object.keys(items);\n    for(var v in keys) {\n        let k = keys[v];\n        let [year,month] = k.split(',')\n        rows.push({location,year,month,value:Number(items[k])||0});\n    }\n    return rows;\n\n}\ndoit().then(values => runtime.done({values})).catch(e => runtime.error(e));","timeoutMilliseconds":5000},{"title":"Replace one document","type":"modelcollections:replaceone","id":"b28df3cb-3ebe-4e8c-becf-bc13d6742377","position":{"left":320,"top":100},"surface":"UpdateCategory","connections":{"inputs":[{"source":"2c4acc75-9169-49a7-93bc-e0d9d2508141:output:label","target":"b28df3cb-3ebe-4e8c-becf-bc13d6742377:input:label"},{"source":"2c4acc75-9169-49a7-93bc-e0d9d2508141:output:subcategories","target":"b28df3cb-3ebe-4e8c-becf-bc13d6742377:input:subcategories"},{"source":"2c4acc75-9169-49a7-93bc-e0d9d2508141:output:id","target":"b28df3cb-3ebe-4e8c-becf-bc13d6742377:input:id"}],"outputs":[{"source":"b28df3cb-3ebe-4e8c-becf-bc13d6742377:output:output","target":"5fb57472-1525-4d83-e75a-99d030566e38:input:trigger"}]},"inputValues":[{"id":"trigger","type":"","label":"Trigger","value":"","description":"","documentation":"","transformation":"","disablelog":""},{"id":"id","type":"","label":"id","value":"","description":"","documentation":"","transformation":"","disablelog":""},{"id":"label","type":"","label":"label","value":"","description":"","documentation":"","transformation":"","disablelog":""},{"id":"subcategories","type":"","label":"subcategories","value":"","description":"","documentation":"","transformation":"","disablelog":""},{"id":"__data__","type":"text","label":"Data","value":"","description":"Data to be inserted","documentation":"","transformation":"","disablelog":""}],"outputValues":[{"id":"__error__","type":"error","label":"Error","description":"","documentation":"","example":"","dataType":""},{"id":"output","type":"","label":"All Output","description":"","documentation":"","example":"","dataType":""}],"CollectionName":"e692f2de-5335-4bcc-da84-53a32b5732ad","configuration":"[{\"IsEither\":true,\"Conditions\":[{\"Attribute\":\"id\",\"Operator\":\"eq\",\"Value\":\"id\",\"IsPin\":true}],\"Groups\":[]}]","UpdateAsAttributes":true,"ReceiveIndividualFields":false,"TakeFilterFromPin":false,"timeout":5000},{"title":"Action","type":"actionstart","id":"9ea5ceca-da4a-4f57-d479-f1f09412d57a","position":{"left":60,"top":60},"surface":"ChangeLocationName","connections":{"inputs":[],"outputs":[{"source":"9ea5ceca-da4a-4f57-d479-f1f09412d57a:output:oldName","target":"11b73ec6-9b47-467a-d964-82069ec79722:input:oldName"},{"source":"9ea5ceca-da4a-4f57-d479-f1f09412d57a:output:newName","target":"11b73ec6-9b47-467a-d964-82069ec79722:input:newName"}]},"inputValues":[],"outputValues":[{"id":"output","type":"","label":"All Output","description":"","documentation":"","example":"","dataType":""},{"id":"__error__","type":"error","label":"Error","description":"","documentation":"","example":"","dataType":""},{"id":"oldName","type":"","label":"oldName"},{"id":"newName","type":"","label":"newName"}],"actionName":"ChangeLocationName","initiate":false,"published":false,"debug":false,"roles":[],"static":true,"canOverrideCredentials":false,"docs":"Renames a location. This will affect all existing data as well as budgets. You cannot rename a location to one that is already defined.\n\n# Output\n\n```\n{\"status\":\"ok\"}\n```"},{"title":"ES6Javascript","type":"es6javascript","id":"11b73ec6-9b47-467a-d964-82069ec79722","position":{"left":541,"top":162},"surface":"ChangeLocationName","connections":{"inputs":[{"source":"9ea5ceca-da4a-4f57-d479-f1f09412d57a:output:oldName","target":"11b73ec6-9b47-467a-d964-82069ec79722:input:oldName"},{"source":"9ea5ceca-da4a-4f57-d479-f1f09412d57a:output:newName","target":"11b73ec6-9b47-467a-d964-82069ec79722:input:newName"}],"outputs":[{"source":"11b73ec6-9b47-467a-d964-82069ec79722:output:status","target":"bf98a33b-12fa-430d-cd8a-a2166758f53f:input:input"}]},"inputValues":[{"id":"trigger","type":"","label":"Trigger","value":"","description":"","documentation":"","transformation":"","disablelog":""},{"id":"oldName","type":"","label":"oldName","value":"","description":"","documentation":"","transformation":"","disablelog":""},{"id":"newName","type":"","label":"newName","value":"","description":"","documentation":"","transformation":"","disablelog":""}],"outputValues":[{"id":"__error__","type":"error","label":"Error","description":"","documentation":"","example":"","dataType":""},{"id":"status","type":"","label":"status","description":"","documentation":"","example":"","dataType":""}],"description":"","code":"async function main() {\n    let {oldName,newName} = runtime.inputs();\n\n    let col = lucy.currentModel().collections();\n\n    let items = await col.findOne('budget',{'location':newName},{});\n\n    if (items != null && items.location) {\n        throw newName + ' already defined under budgets. You cannot rename a location to one that is already defined';\n    }\n\n    items = await col.findOne('consumption',{'location':newName},{});\n    if (items != null && items.location) {\n        throw newName + ' is already present in existing data. You cannot rename a location to one that already has data';\n    }\n    \n    await col.updateMany('budget',{'location':oldName},{'$set':{'location':newName}},{});\n    await col.updateMany('consumption',{'location':oldName},{'$set':{'location':newName}},{});\n    return 'ok';\n}\n\nmain().then(s => runtime.done({status:s})).catch(_ => runtime.error(_));","timeoutMilliseconds":5000},{"title":"ES6Javascript","type":"es6javascript","id":"0b1ebff4-ea83-4b5c-f406-7479e1aadfa2","position":{"left":320,"top":100},"surface":"AddValueBulk","connections":{"inputs":[{"source":"e5d4b92e-068d-4dac-c81c-8d3c7b3d7255:output:values","target":"0b1ebff4-ea83-4b5c-f406-7479e1aadfa2:input:values"}],"outputs":[{"source":"0b1ebff4-ea83-4b5c-f406-7479e1aadfa2:output:values","target":"c8837ab4-aa1a-4847-e5c1-a05b4841b4c1:input:list"}]},"inputValues":[{"id":"trigger","type":"","label":"Trigger","value":"","description":"","documentation":"","transformation":"","disablelog":""},{"id":"values","type":"","label":"values","value":"","description":"","documentation":"","transformation":"","disablelog":""}],"outputValues":[{"id":"__error__","type":"error","label":"Error","description":"","documentation":"","example":"","dataType":""},{"id":"values","type":"","label":"values","description":"","documentation":"","example":"","dataType":""}],"description":"","code":"let values = runtime.inputs().values;\nif (!values) {\n    throw 'Provide an array of year/month/day values';\n}\nif (!(values instanceof Array)) {\n    throw 'values should be an array';\n}\nruntime.done({values});","timeoutMilliseconds":5000},{"title":"Output","type":"actionoutput","id":"bf98a33b-12fa-430d-cd8a-a2166758f53f","position":{"left":279,"top":334},"surface":"ChangeLocationName","connections":{"inputs":[{"source":"11b73ec6-9b47-467a-d964-82069ec79722:output:status","target":"bf98a33b-12fa-430d-cd8a-a2166758f53f:input:input"}],"outputs":[]},"inputValues":[{"id":"input","type":"","label":"Value","value":"","description":"","documentation":"","transformation":"","disablelog":""},{"id":"trigger","type":"","label":"Trigger","value":"","description":"","documentation":"","transformation":"","disablelog":""}],"outputValues":[],"fieldName":"status"},{"title":"Action","type":"actionstart","id":"5a471ef8-e835-49b9-beb0-72f42c25c45a","position":{"left":100,"top":100},"surface":"ConsumptionForLocationMonth","connections":{"inputs":[],"outputs":[{"source":"5a471ef8-e835-49b9-beb0-72f42c25c45a:output:location","target":"097dafad-630d-4cf1-a208-67219475e888:input:location"},{"source":"5a471ef8-e835-49b9-beb0-72f42c25c45a:output:year","target":"097dafad-630d-4cf1-a208-67219475e888:input:year"},{"source":"5a471ef8-e835-49b9-beb0-72f42c25c45a:output:month","target":"097dafad-630d-4cf1-a208-67219475e888:input:month"},{"source":"5a471ef8-e835-49b9-beb0-72f42c25c45a:output:category","target":"097dafad-630d-4cf1-a208-67219475e888:input:category"}]},"inputValues":[],"outputValues":[{"id":"output","type":"","label":"All Output","description":"","documentation":"","example":"","dataType":""},{"id":"__error__","type":"error","label":"Error","description":"","documentation":"","example":"","dataType":""},{"id":"location","type":"","label":"location","description":"","documentation":"","example":"","dataType":""},{"id":"year","type":"","label":"year","description":"","documentation":"","example":"","dataType":""},{"id":"month","type":"","label":"month","description":"","documentation":"","example":"","dataType":""},{"id":"category","type":"","label":"category","description":"","documentation":"","example":"","dataType":""}],"actionName":"ConsumptionForLocationMonth","initiate":false,"published":false,"debug":false,"roles":[],"static":true,"canOverrideCredentials":false,"docs":"Get consumption information for a given energy type, year, month and location"},{"title":"ES6Javascript","type":"es6javascript","id":"cf1482da-fd5b-4b2a-9dd0-9159b6ff89bb","position":{"left":478,"top":181},"surface":"GetLocationsAndCategories","connections":{"inputs":[{"source":"b6db3877-68b6-4515-c0e2-6b9e9552f2ae:output:output","target":"cf1482da-fd5b-4b2a-9dd0-9159b6ff89bb:input:trigger"}],"outputs":[{"source":"cf1482da-fd5b-4b2a-9dd0-9159b6ff89bb:output:locations","target":"d3295518-9efc-4801-eacc-50cf3711200e:input:input"},{"source":"cf1482da-fd5b-4b2a-9dd0-9159b6ff89bb:output:categories","target":"f58f48f8-14fe-4f57-a176-65ebaad4e5d6:input:input"}]},"inputValues":[{"id":"trigger","type":"","label":"Trigger","value":"","description":"","documentation":"","transformation":"","disablelog":""}],"outputValues":[{"id":"__error__","type":"error","label":"Error","description":"","documentation":"","example":"","dataType":""},{"id":"locations","type":"","label":"locations","description":"","documentation":"","example":"","dataType":""},{"id":"categories","type":"","label":"categories","description":"","documentation":"","example":"","dataType":""}],"description":"","code":"let dc = lucy.currentModel().collections();\n\nfunction addToBudget(budget,toAdd) {\n    let newBudget = [];\n    for(let i=0;i<12;i++) {\n        let total = (Number(budget[i]) || 0) + (Number(toAdd[i])||0);\n        newBudget.push(total);\n    }\n    return newBudget;\n}\nasync function doit() {\n    let categories = await dc.findMany('categories',{},{});\n    let locations = await dc.findMany('budget',{},{});\n    let locationMap = {};\n    let categoryMap = {};\n    for(let loc of locations) {\n        let l = loc.location;\n        if (!locationMap[l]) {\n            locationMap[l] = {};\n        }\n        locationMap[l][loc.category] = loc.values;\n        categoryMap[loc.category] = 1;\n    }\n    for(let c of categories) {\n        categoryMap[c.id] = 1;\n    }\n    let computedLocations = [];\n    function getCategories(c) {\n        let item = categories.find(x => x.id == c);\n        if (!item) return [c];\n        return item.subcategories || [c];\n    }\n    let newLocations = [];\n    let oldLocations = Object.keys(locationMap);\n    for(let loc of oldLocations) {\n        let allCategories = Object.keys(categoryMap);\n        for(let cb of allCategories) {\n            let values = [0,0,0,0,0,0,0,0,0,0,0,0];\n            \n            // list of categories that this category computes to. Maybe just one\n            let categories = getCategories(cb);\n            for(let cat of categories) {\n                let catValues = locationMap[loc][cat] || [];\n                values = addToBudget(values,catValues);\n            }\n\n            newLocations.push({location:loc,category:cb,values});\n\n        }\n    }\n   \n    return {locations:newLocations,categories};\n}\ndoit().then(values => runtime.done(values)).catch(e => runtime.error(e));","timeoutMilliseconds":5000},{"title":"Output","type":"actionoutput","id":"001227d8-6f6b-4de4-93f0-85e02ab0eafa","position":{"left":744,"top":82},"surface":"GetBudget","connections":{"inputs":[{"source":"25de88e0-0483-4302-dee8-e164b6166822:output:values","target":"001227d8-6f6b-4de4-93f0-85e02ab0eafa:input:trigger"}],"outputs":[]},"inputValues":[{"id":"input","type":"","label":"Value","value":"#{input.location}","description":"","documentation":"","transformation":"","disablelog":""},{"id":"trigger","type":"","label":"Trigger","value":"","description":"","documentation":"","transformation":"","disablelog":""}],"outputValues":[],"fieldName":"location"},{"title":"Delete one document","type":"modelcollections:deleteone","id":"92b68200-fd76-4676-c225-3b01e0dafd76","position":{"left":383,"top":77},"surface":"DeleteCategory","connections":{"inputs":[{"source":"11d0d5ee-50bb-4614-efb1-0b3584815223:output:category","target":"92b68200-fd76-4676-c225-3b01e0dafd76:input:category"}],"outputs":[{"source":"92b68200-fd76-4676-c225-3b01e0dafd76:output:output","target":"d0ea2c3c-ed1f-4d08-cb60-78f358bbccc0:input:trigger"}]},"inputValues":[{"id":"trigger","type":"","label":"Trigger","value":"","description":"","documentation":"","transformation":"","disablelog":""},{"id":"category","type":"","label":"category","value":"","description":"","documentation":"","transformation":"","disablelog":""}],"outputValues":[{"id":"__error__","type":"error","label":"Error","description":"","documentation":"","example":"","dataType":""},{"id":"output","type":"","label":"All Output","description":"","documentation":"","example":"","dataType":""}],"CollectionName":"e692f2de-5335-4bcc-da84-53a32b5732ad","configuration":"[{\"IsEither\":true,\"Conditions\":[{\"Attribute\":\"id\",\"Operator\":\"eq\",\"Value\":\"category\",\"IsPin\":true}],\"Groups\":[]}]","UpdateAsAttributes":false,"ReceiveIndividualFields":false,"TakeFilterFromPin":false,"timeout":5000},{"title":"Output","type":"actionoutput","id":"d3295518-9efc-4801-eacc-50cf3711200e","position":{"left":963,"top":60},"surface":"GetLocationsAndCategories","connections":{"inputs":[{"source":"cf1482da-fd5b-4b2a-9dd0-9159b6ff89bb:output:locations","target":"d3295518-9efc-4801-eacc-50cf3711200e:input:input"}],"outputs":[]},"inputValues":[{"id":"input","type":"","label":"Value","value":"","description":"","documentation":"","transformation":"","disablelog":""},{"id":"trigger","type":"","label":"Trigger","value":"","description":"","documentation":"","transformation":"","disablelog":""}],"outputValues":[],"fieldName":"locations"},{"title":"Action","type":"actionstart","id":"27be8965-0237-43f3-921e-92c27d5d468c","position":{"left":59,"top":127},"surface":"GetCategories","connections":{"inputs":[],"outputs":[{"source":"27be8965-0237-43f3-921e-92c27d5d468c:output:output","target":"72934bb1-8f28-40aa-c5a0-8b404ea09d9b:input:trigger"}]},"inputValues":[],"outputValues":[{"id":"output","type":"","label":"All Output","description":"","documentation":"","example":"","dataType":""},{"id":"__error__","type":"error","label":"Error","description":"","documentation":"","example":"","dataType":""}],"actionName":"GetCategories","initiate":false,"published":false,"debug":false,"roles":[],"static":true,"canOverrideCredentials":false,"docs":""},{"title":"Replace one document","type":"modelcollections:replaceone","id":"1542c611-629c-4474-dd1c-06bcc5ff2b91","position":{"left":903,"top":108},"surface":"UpdateBudget","connections":{"inputs":[{"source":"d97a6545-564f-4126-f5d3-4f49aada8492:output:ok","target":"1542c611-629c-4474-dd1c-06bcc5ff2b91:input:trigger"},{"source":"40fe7e19-b46c-40e7-a08a-9339de42e42e:output:budget","target":"1542c611-629c-4474-dd1c-06bcc5ff2b91:input:values"},{"source":"40fe7e19-b46c-40e7-a08a-9339de42e42e:output:location","target":"1542c611-629c-4474-dd1c-06bcc5ff2b91:input:location"},{"source":"40fe7e19-b46c-40e7-a08a-9339de42e42e:output:category","target":"1542c611-629c-4474-dd1c-06bcc5ff2b91:input:category"}],"outputs":[]},"inputValues":[{"id":"trigger","type":"","label":"Trigger","value":"","description":"","documentation":"","transformation":"","disablelog":""},{"id":"location","type":"","label":"location","value":"","description":"","documentation":"","transformation":"","disablelog":""},{"id":"values","type":"","label":"values","value":"","description":"","documentation":"","transformation":"","disablelog":""},{"id":"category","type":"","label":"category","value":"","description":"","documentation":"","transformation":"","disablelog":""},{"id":"__data__","type":"text","label":"Data","value":"","description":"Data to be inserted","documentation":"","transformation":"","disablelog":""}],"outputValues":[{"id":"__error__","type":"error","label":"Error","description":"","documentation":"","example":"","dataType":""},{"id":"output","type":"","label":"All Output","description":"","documentation":"","example":"","dataType":""}],"CollectionName":"c0ecc1d2-c1ef-4db8-f5c6-f260e438b66a","configuration":"[{\"IsEither\":false,\"Conditions\":[{\"Attribute\":\"location\",\"Operator\":\"eq\",\"Value\":\"location\",\"IsPin\":true},{\"Attribute\":\"category\",\"Operator\":\"eq\",\"Value\":\"category\",\"IsPin\":true}],\"Groups\":[]}]","UpdateAsAttributes":true,"ReceiveIndividualFields":false,"TakeFilterFromPin":false,"timeout":5000}],"position":{"top":0,"left":0}},"sources":[{"name":"UpdateCategory","published":false,"static":true,"initiate":false,"canOverrideCredentials":false,"outputs":["status"],"parameters":["label","subcategories","id"]},{"name":"ChangeLocationName","published":false,"static":true,"initiate":false,"canOverrideCredentials":false,"outputs":["status"],"parameters":["oldName","newName"]},{"name":"ConsumptionForLocationMonth","published":false,"static":true,"initiate":false,"canOverrideCredentials":false,"outputs":[""],"parameters":["location","year","month","category"]},{"name":"GetLocations","published":false,"static":true,"initiate":false,"canOverrideCredentials":false,"outputs":[""],"parameters":[]},{"name":"CategoryConsumptionForLocation","published":false,"static":true,"initiate":false,"canOverrideCredentials":false,"outputs":[""],"parameters":["location","year","month"]},{"name":"AddValueBulk","published":false,"static":true,"initiate":false,"canOverrideCredentials":false,"outputs":[],"parameters":["values","location"]},{"name":"UpdateBudget","published":false,"static":true,"initiate":false,"canOverrideCredentials":false,"outputs":[],"parameters":["location","budget","category"]},{"name":"AddValue","published":false,"static":true,"initiate":false,"canOverrideCredentials":false,"outputs":[],"parameters":["year","month","location","value","category"]},{"name":"GetBudget","published":false,"static":true,"initiate":false,"canOverrideCredentials":false,"outputs":["values","location"],"parameters":["location","category"]},{"name":"ConsumptionForLocation","published":false,"static":true,"initiate":false,"canOverrideCredentials":false,"outputs":[""],"parameters":["location","year","category"]},{"name":"ConsumptionBreakdownForLocationMonth","published":false,"static":true,"initiate":false,"canOverrideCredentials":false,"outputs":[""],"parameters":["location","year","month"]},{"name":"DeleteCategory","published":false,"static":true,"initiate":false,"canOverrideCredentials":false,"outputs":["status"],"parameters":["category"]},{"name":"GetLocationsAndCategories","published":false,"static":true,"initiate":false,"canOverrideCredentials":false,"outputs":["locations","categories"],"parameters":[]},{"name":"GetCategories","published":false,"static":true,"initiate":false,"canOverrideCredentials":false,"outputs":[""],"parameters":[]}],"actions":[{"name":"UpdateCategory","published":false,"static":true,"initiate":false,"canOverrideCredentials":false,"outputs":["status"],"parameters":["label","subcategories","id"]},{"name":"ChangeLocationName","published":false,"static":true,"initiate":false,"canOverrideCredentials":false,"outputs":["status"],"parameters":["oldName","newName"]},{"name":"ConsumptionForLocationMonth","published":false,"static":true,"initiate":false,"canOverrideCredentials":false,"outputs":[""],"parameters":["location","year","month","category"]},{"name":"GetLocations","published":false,"static":true,"initiate":false,"canOverrideCredentials":false,"outputs":[""],"parameters":[]},{"name":"CategoryConsumptionForLocation","published":false,"static":true,"initiate":false,"canOverrideCredentials":false,"outputs":[""],"parameters":["location","year","month"]},{"name":"AddValueBulk","published":false,"static":true,"initiate":false,"canOverrideCredentials":false,"outputs":[],"parameters":["values","location"]},{"name":"UpdateBudget","published":false,"static":true,"initiate":false,"canOverrideCredentials":false,"outputs":[],"parameters":["location","budget","category"]},{"name":"AddValue","published":false,"static":true,"initiate":false,"canOverrideCredentials":false,"outputs":[],"parameters":["year","month","location","value","category"]},{"name":"GetBudget","published":false,"static":true,"initiate":false,"canOverrideCredentials":false,"outputs":["values","location"],"parameters":["location","category"]},{"name":"ConsumptionForLocation","published":false,"static":true,"initiate":false,"canOverrideCredentials":false,"outputs":[""],"parameters":["location","year","category"]},{"name":"ConsumptionBreakdownForLocationMonth","published":false,"static":true,"initiate":false,"canOverrideCredentials":false,"outputs":[""],"parameters":["location","year","month"]},{"name":"DeleteCategory","published":false,"static":true,"initiate":false,"canOverrideCredentials":false,"outputs":["status"],"parameters":["category"]},{"name":"GetLocationsAndCategories","published":false,"static":true,"initiate":false,"canOverrideCredentials":false,"outputs":["locations","categories"],"parameters":[]},{"name":"GetCategories","published":false,"static":true,"initiate":false,"canOverrideCredentials":false,"outputs":[""],"parameters":[]}],"uioptions":{}},"UIDefinition":null,"MetadataDictionary":"{\"parameters\":[{\"id\":\"energymodel\",\"label\":\"Energy Provider\",\"type\":\"model\",\"subtype\":\"energy-provider\"},{\"id\":\"locationmodel\",\"label\":\"Location Provider\",\"type\":\"model\",\"subtype\":\"locations-provider\"}],\"title\":\"Energy Budget\",\"description\":\"This model provides visualizations around energy savings\",\"tags\":[\"energy\"],\"capabilities\":[\"energy-budget-provider\"]}","ApiRoutes":[{"Key":"609","MapKey":"8","Route":"budget/{location}/{category}","Method":"GET","BodyFormat":"JSON","QueryParams":"[]","IsActive":"0","Action":"GetBudget","NoAuth":"0"},{"Key":"610","MapKey":"8","Route":"budget/{location}/{category}","Method":"POST","BodyFormat":"JSON","QueryParams":"[]","IsActive":"0","Action":"UpdateBudget","NoAuth":"0"},{"Key":"611","MapKey":"8","Route":"locations","Method":"GET","BodyFormat":"JSON","QueryParams":"[]","IsActive":"0","Action":"GetLocations","NoAuth":"0"},{"Key":"612","MapKey":"8","Route":"consumption/{location}/{category}/{year}","Method":"GET","BodyFormat":"JSON","QueryParams":"[]","IsActive":"0","Action":"ConsumptionForLocation","NoAuth":"0"},{"Key":"613","MapKey":"8","Route":"consumption/{location}/{category}/{year}/{month}","Method":"POST","BodyFormat":"JSON","QueryParams":"[]","IsActive":"0","Action":"AddValue","NoAuth":"0"},{"Key":"614","MapKey":"8","Route":"consumption/{location}/{category}/{year}/{month}","Method":"GET","BodyFormat":"JSON","QueryParams":"[]","IsActive":"0","Action":"ConsumptionForLocationMonth","NoAuth":"0"},{"Key":"615","MapKey":"8","Route":"consumption/{location}","Method":"POST","BodyFormat":"JSON","QueryParams":"[]","IsActive":"0","Action":"AddValueBulk","NoAuth":"0"},{"Key":"616","MapKey":"8","Route":"categories","Method":"POST","BodyFormat":"JSON","QueryParams":"[]","IsActive":"0","Action":"UpdateCategory","NoAuth":"0"},{"Key":"617","MapKey":"8","Route":"categories","Method":"GET","BodyFormat":"JSON","QueryParams":"[]","IsActive":"0","Action":"GetCategories","NoAuth":"0"},{"Key":"618","MapKey":"8","Route":"categories/{category}","Method":"DELETE","BodyFormat":"JSON","QueryParams":"[]","IsActive":"0","Action":"DeleteCategory","NoAuth":"0"},{"Key":"619","MapKey":"8","Route":"locations/name","Method":"PATCH","BodyFormat":"JSON","QueryParams":"[]","IsActive":"0","Action":"ChangeLocationName","NoAuth":"0"}],"JSModules":[],"ModelCollections":[{"Key":"184","MapKey":"8","GUID":"990e1f47-05ec-4225-e2c1-4037cdb70bac","Attributes":"[{\"name\":\"year\"},{\"name\":\"month\"},{\"name\":\"value\"},{\"name\":\"location\"},{\"name\":\"category\"}]","Name":"consumption"},{"Key":"185","MapKey":"8","GUID":"c0ecc1d2-c1ef-4db8-f5c6-f260e438b66a","Attributes":"[{\"name\":\"location\"},{\"name\":\"values\"},{\"name\":\"category\"}]","Name":"budget"},{"Key":"186","MapKey":"8","GUID":"e692f2de-5335-4bcc-da84-53a32b5732ad","Attributes":"[{\"name\":\"id\"},{\"name\":\"label\"},{\"name\":\"subcategories\"}]","Name":"categories"}]}]}